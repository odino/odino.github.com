
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>REST better: common pitfalls - Alessandro Nadalin</title>
  <meta name="author" content="Alessandro Nadalin">

  
  <meta name="description" content="REST is a critical buzzword since 10 years, and I really don&rsquo;t know why: seems like this 4 letters altogether, R E S T, have a magical power on &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://odino.org/rest-better-common-pitfalls/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Alessandro Nadalin" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic' rel='stylesheet' type='text/css'>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-7407627-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <img id="bio-picture" src="https://lh6.googleusercontent.com/-YgvT5_ULkUk/AAAAAAAAAAI/AAAAAAAAAWY/lIfaFw-9ZQo/s120-c/photo.jpg" />
  <h1><a href="/">Alessandro Nadalin</a></h1>
</hgroup>

<ul id="topmenu">
	<li>
		<a href="/about" >
			about
		</a>
	</li>
	<li>
		<a href="/conferences" >
			conferences
		</a>
	</li>
	<li>
		<a href="http://twitter.com/_odino_" >
			twitter
		</a>
	</li>
	<li>
		<a href="/archives" >
			archives
		</a>
	</li>
</ul>

</header>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">REST Better: Common Pitfalls</h1>
    
  </header>




<span class="categories">
  
    <a class='category' href='/blog/categories/rest/'>REST</a>
  
</span>


<div class="entry-content"><p>REST is a critical buzzword since 10 years, and I really don&rsquo;t know why: seems like this 4 letters altogether, R E S T, have a magical power on IT people&rsquo;s brain<sup id='fnref:1'><a href='#fn:1' rel='footnote'>1</a></sup>&hellip;</p>

<!-- more -->


<p><img class="right" src="/images/witch.jpg"></p>

<p>In the last months I talked with a few people referring to <strong>that word</strong> with no clue about what it actually means, that&rsquo;s why I would like to sum up some common misunderstanding about <strong>that word</strong>.</p>

<p><strong>No one was born learned</strong> ( that&rsquo;s an italian expression, hope you got it ), so I&rsquo;d like to share the following thoughts to shutter some myths.</p>

<h2>Clean URIs, strict schemas</h2>

<p>It&rsquo;s fun how <a href="http://www.slideshare.net/Wombert/designing-http-interfaces-and-restful-web-services-confoo11-20110310/60">David Zuelke introduces this concept in 3 slides</a>.</p>

<p>Why is this ironic?</p>

<p>We are used to think that REST says we should use a unique uri for each resource, and that URIs should be hierarchical.</p>

<p>Don&rsquo;t get me wrong: a URI must not point to different resources, that would mean the introduction of state into the communication, and the greatest problem with this approach is that your resources aren&rsquo;t linkable and, for example, you won&rsquo;t be able to bookmark them ( since I&rsquo;m lazy I don&rsquo;t want to talk about <strong>scalability</strong> for now&hellip;  ).</p>

<p>It&rsquo;s like having a POST-based search engine for the end user ( or one of those <a href="http://www.pxel.tk/">cheap TK sites</a> )&hellip; like using HTTP without its constraint and features ( llike statelessness and hypermedia, in this case ).</p>

<p>While 1-N relations are totally wrong ( and, therefore, N-N ), N-1 relations are <strong>perfectly OK</strong>.</p>

<p>You are probably used to listen people saying that your resource must by identified by a single URI ( and worse people tend to say its identifier must be a numerical resource ID ), but, although this is a good approach, we can get over it ( through hypermedia ).</p>

<p><img class="left" src="/images/URIschema.jpg"></p>

<p>The biggest problem with URI schemas and common URI/verb mapping is that they&rsquo;ve become a set of conventions to guide the consumer through the services, completely <strong>ignoring the hypermedia constraint of REST</strong>.</p>

<p>It&rsquo;s because of this that Zuelke says this part is hironic: through hypermedia we don&rsquo;t have to give to the client tons of documentation, and we don&rsquo;t have to be afraid of changing the location of our resources. <strong>An hypermedia-aware client is able to adapt to our service</strong> as long we change some aspects of the implementation ( like locations ).</p>

<h2>Wait, URIs matter somehow</h2>

<p>Ehi, I&rsquo;m not advocating that the URI/verb map you see on the right is wrong: we just don&rsquo;t need it.</p>

<p>But if you are conscious about hypermedia and want to follow this kind of schemas, you have plain support in doing so: they help you design widely-recognized clean URIs.</p>

<h2>POX over HTTP</h2>

<blockquote><p>You know, I have this REST webservice&#8230;<br/>Since today there&#8217;s a boom of mobile apps it&#8217;s cool to have them act as a proxy between the phone and the real content on the web via some REST APIs.<br/>So I wanted to know if there were some PHP frameworks out there that could help me writing this APIs&#8230; Do you know something?<br/>This was a question I received during a geek dinner from a young programmer, that, basically, wanted to use stuff like Frapi and Recess.</p></blockquote>


<p>The problem was that when, after this short description, I asked what he wanted to do for this &ldquo;REST&rdquo; API, the response was:</p>

<blockquote><p>Well, you know, an HTTP request, then an XML back&#8230;</p></blockquote>


<p>that was what I imagined: this guy thought that REST means an HTTP requests serving an XML back into the response.</p>

<p>I talked to him about other awesomeness of REST but I bet he didn&rsquo;t care too much..</p>

<p>Well, getting back to us, the problem with POX ( <em>Plain Old Xml</em> ) over HTTP is that you are missing some fundamentals about RESTful architectures, and, therefore, the benefits they give you:</p>

<ul>
<li>having only XML ( although acceptable ) brings away <strong>content negotiation</strong>, which is basically a commodity for your clients</li>
<li><a href="http://www.google.it/imgres?imgurl=http://www.sqlservercentral.com/articles/SS2K5%2B-%2BXML/2826/xml_result1.gif&amp;imgrefurl=http://www.sqlservercentral.com/articles/SS2K5%2B-%2BXML/2826/&amp;usg=__VTGK7M7iMz05Faa-gqox9ziWiio=&amp;h=566&amp;w=576&amp;sz=19&amp;hl=it&amp;start=0&amp;sig2=8scznEq2t7fI6w5GyVaCnw&amp;zoom=1&amp;tbnid=--Cfpfrp2ulFRM:&amp;tbnh=164&amp;tbnw=167&amp;ei=TQGFTcKTIYzEsgb8v_yaAw&amp;prev=/images%3Fq%3Dxml%26um%3D1%26hl%3Dit%26safe%3Doff%26sa%3DN%26biw%3D1280%26bih%3D690%26tbs%3Disch:1&amp;um=1&amp;itbs=1&amp;iact=hc&amp;vpx=141&amp;vpy=363&amp;dur=1808&amp;hovh=223&amp;hovw=226&amp;tx=189&amp;ty=149&amp;oei=TQGFTcKTIYzEsgb8v_yaAw&amp;page=1&amp;ndsp=16&amp;ved=1t:429,r:11,s:0">POX</a> drops support for hypermedia, reducing your service&rsquo;s durability, mantainability and non-breaking retrocompatibility capabilities</li>
</ul>


<p>Roughly speaking, if you think at REST like POX over HTTP you are also probably missing some other monumental benefits of REST, like the ones brought by the <a href="http://www.odino.org/301/rest-better-http-cache">cache</a>.</p>

<h2>Verbs are enough</h2>

<blockquote><p>No, it&#8217;s REST: it uses aso PUT and DELETE!</p></blockquote>


<p>Another pitfall you may have encountered in your career is when you think that verbs ( <em>HTTP method</em> in 99% of the cases ) are enough to define REST a service.</p>

<p>Without adhering to the principles of cacheability, statelessness, stratification and to the <a href="http://www.w3.org/2003/Talks/techplen-http/slide6-0.html">uniform interface</a>, your service will never be considered RESTful.</p>

<p>Ah, and it should also happen between a client and a server, but this just sounded obvious.</p>

<h2>The SOAPy  way</h2>

<p>Let me introduce you <em>The SOAPy way</em>, which is basically SOAP with REST clothes :)</p>

<p>The most common SOAPy pitfall occurs when you think that, in case of any error, <strong>your application should always return a 500, specifying the error in the body of the response</strong>.</p>

<p>That is a terrible mistake, moreover when you think that GETting a resource that doesn&rsquo;t exist anymore is an error, for you.</p>

<p><strong>404 turns into 500</strong>.</p>

<p>You are basically rewriting a layer HTTP has already implemented: waste.</p>

<p>An HTTP-loving client would not understand your DAP ( <em>Domain Application Protocol</em> ), because you have just re-invented protocol semantics under the DAP itself!</p>

<p>The <a href="http://www.symfony-framework.org/">symfony 1.X</a> framework does a similar thing when, with its admin generator, generates the actions able to create and redirect the browser to the just created resource: it basically uses an <a href="https://github.com/symfony/symfony1/blob/master/lib/plugins/sfDoctrinePlugin/data/generator/sfDoctrineModule/admin/parts/processFormAction.php#L36">explicit redirect</a> ( <code>302</code> ), without telling the client that the object has been created ( <code>201</code> ), giving informations about its current place ( <code>Location</code> header ).</p>

<p>What&rsquo;s wrong with this? When you create an element you will always have to wait for the redirect in order to know if the resource has been created.</p>

<p>Gosh&hellip;</p>

<h2>There is one more thing</h2>

<blockquote><p>How much you learned today is indicated by level of embarrassment at what you did yesterday.<br/>Trust me: that level of embarassment, is the one I feel at least once a week ;-)</p><footer><strong>Jurgen Appelo,</strong> <cite><a href='http://twitter.com/#!/jacoporomei/status/46316430379065344'>twitter.com/#!/jacoporomei/&hellip;</a></cite></footer></blockquote>




<div class="footnotes">
<span>
Notes
</span>
    <ol>
        <li id='fn:1'>Cloud computing is another one <a href='#fnref:1' rev='footnote'>↩</a></li>
    </ol>
</div>



</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Alessandro Nadalin</span></span>

      








  


<time datetime="2011-03-19T22:54:00+04:00" pubdate data-updated="true">Saturday, 19 March 2011 at 22:54</time>
    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://odino.org/rest-better-common-pitfalls/" data-via="_odino_" data-counturl="http://odino.org/rest-better-common-pitfalls/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/be-clever-with-your-etags/" title="Previous Post: Be clever with your Etags">&laquo; Be clever with your Etags</a>
      
      
        <a class="basic-alignment right" href="/singletons-of-the-web/" title="Next Post: Singletons of the web">Singletons of the web &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Alessandro Nadalin -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'odino';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://odino.org/rest-better-common-pitfalls/';
        var disqus_url = 'http://odino.org';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/javascripts/aharris.js"></script>

</body>
</html>
