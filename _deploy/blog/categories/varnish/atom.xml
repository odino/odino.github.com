<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Varnish | Alessandro Nadalin]]></title>
  <link href="http://odino.org/blog/categories/varnish/atom.xml" rel="self"/>
  <link href="http://odino.org/"/>
  <updated>2013-07-13T18:06:30+04:00</updated>
  <id>http://odino.org/</id>
  <author>
    <name><![CDATA[Alessandro Nadalin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Installing and configuring Varnish on Ubuntu]]></title>
    <link href="http://odino.org/installing-and-configuring-varnish-on-ubuntu/"/>
    <updated>2011-02-09T02:29:00+04:00</updated>
    <id>http://odino.org/installing-and-configuring-varnish-on-ubuntu</id>
    <content type="html"><![CDATA[<p>On a brand new debian/*ubuntu distro, there are only a couple steps to do in order to make Varnish <del>act as a proxy</del> do its job in front of apache.</p>

<!-- more -->


<p>Installation:</p>

<p><code>
sudo apt-get install varnish
</code></p>

<p>then you need to configure it to listen to the <code>:80</code> port, editing <code>/etc/default/varnish</code>:</p>

<p>```
DAEMON_OPTS=&ldquo;-a :80 \</p>

<pre><code>         -T localhost:6082 \
         -f /etc/varnish/default.vcl \
         -S /etc/varnish/secret \
         -s file,/var/lib/varnish/$INSTANCE/varnish_storage.bin,1G"
</code></pre>

<p>```</p>

<p>and telling it to forward requests to apache ( we&rsquo;re gonna make it listen to the <code>8090</code> ), into the <code>/etc/varnish/default.vcl</code>:</p>

<p>```
backend apache {</p>

<pre><code>    .host = "127.0.0.1";
    .port = "8090";
</code></pre>

<p>}
sub vcl_fetch {</p>

<pre><code>    remove req.http.X-Forwarded-For;
    set    req.http.X-Forwarded-For = req.http.rlnclientipaddr;
    return(deliver);
</code></pre>

<p>}
```</p>

<p>Then it&rsquo;s time to tell apache it has to listen to a new port, in <code>/etc/apache2/ports.conf</code>:</p>

<p><code>
NameVirtualHost *:8090
Listen 127.0.0.1:8090
</code></p>

<p>Make sure the hosts in your <code>/etc/apache2/httpd.conf</code> listen to <code>:*</code> or <code>:8090</code>, then you can start the services:</p>

<p><code>
/etc/init.d/apache2 start
/etc/init.d/varnish start
</code></p>

<p>Now you have varnish responding to all the hosts on the <code>:80</code>: if you experience some troubles try to go deeper with this <a href="http://www.howtoforge.com:8080/putting-varnish-in-front-of-apache-on-ubuntu-debian">extended guide</a>.</p>
]]></content>
  </entry>
  
</feed>
