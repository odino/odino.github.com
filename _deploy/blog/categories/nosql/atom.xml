<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: NoSQL | Alessandro Nadalin]]></title>
  <link href="http://odino.org/blog/categories/nosql/atom.xml" rel="self"/>
  <link href="http://odino.org/"/>
  <updated>2013-09-21T18:15:38+04:00</updated>
  <id>http://odino.org/</id>
  <author>
    <name><![CDATA[Alessandro Nadalin]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Please welcome the Doctrine2 OrientDB ODM]]></title>
    <link href="http://odino.org/please-welcome-the-doctrine-orientdb-odm/"/>
    <updated>2012-12-28T23:12:00+04:00</updated>
    <id>http://odino.org/please-welcome-the-doctrine-orientdb-odm</id>
    <content type="html"><![CDATA[<p>It took almost 2 years from the
<a href="https://github.com/doctrine/orientdb-odm/commit/65929ec57a2e2cb1f4af034d722e17b5339b9d48">first commit</a>,
but <a href="http://www.orientdb.org/">OrientDB</a>&rsquo;s <a href="https://github.com/doctrine/orientdb-odm">PHP ODM</a>
has been finally moved to the
<a href="https://github.com/doctrine/">Doctrine</a>
organization.</p>

<!-- more -->


<h2>New daddy</h2>

<p>I&rsquo;ve blogged <a href="/blog/categories/orientdb/">so many times</a>
about an imminent
integration into the Doctrine ecosystem, but
due to the workload of our contributors and
some major issues we wanted to solve before this,
we were only able to seriously approach the
Doctrine team today.</p>

<p>This is a very good news, as we will be able
to take advantage of the experience of all the
doctrine contributors as well as have a bigger stage
where we can show the ODM: the biggest part of the
ODM is still pending (persistence), but
HTTP binding, query builder and object
hydration are working like a charm, and the few
bugs that we face in <a href="https://github.com/odino/sharah">real-world scenarios</a>
are solved in a matter of minutes.</p>

<h2>And now?</h2>

<p>All the namespaces have been changed, so the old
<code>Congow\Orient</code> has been replaced by
<code>Doctrine\ODM\OrientDB</code> and <code>Doctrine\OrientDB</code>:
if you were already using the library, you will need
to work on the migration a bit.</p>

<p>You may also want to have a look at the new
<a href="https://packagist.org/packages/doctrine/orientdb-odm">Packagist page</a>,
as it contains the references to the new repository.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Video introduction about NoSQL graph databases and OrientDB]]></title>
    <link href="http://odino.org/video-introduction-about-nosql-graph-databases-and-orientdb/"/>
    <updated>2012-12-08T15:56:00+04:00</updated>
    <id>http://odino.org/video-introduction-about-nosql-graph-databases-and-orientdb</id>
    <content type="html"><![CDATA[<p>During October of the last year, me and my ex-colleague David
took some time off to partecipate to the <a href="http://phpcon.pl/2011/pl/">polish PHP Conference</a>
with a talk about graph databases, OrientDB and how to integrate it
in PHP.</p>

<!-- more -->


<p>I recently found out that the videos recorded at the conference
finally made it to Vimeo: enjoy some tarzan english!</p>

<iframe src="http://player.vimeo.com/video/53451968?badge=0" width="720" height="600" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>


<p> <p><a href="http://vimeo.com/53451968">Alessandro Nadalin, David Funaro: Graph databases and PHP: time for serious stuff</a> from <a href="http://vimeo.com/user10854134">PLUG</a> on <a href="http://vimeo.com">Vimeo</a>.</p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Back in track with OrientDB]]></title>
    <link href="http://odino.org/back-in-track-with-orientdb/"/>
    <updated>2012-04-20T15:26:00+04:00</updated>
    <id>http://odino.org/back-in-track-with-orientdb</id>
    <content type="html"><![CDATA[<p>It&rsquo;s been a while since I don&rsquo;t release any update about
Orient, the PHP data mapper for OrientDB: we recently got
back on track and I have a few interesting news.</p>

<!-- more -->


<p>I just moved to Dubai, as you may know, so the last couple
of months have been a huge mess for me, while David was
doing some <a href="https://github.com/congow/Orient/tree/persistence">major experiments</a>
for the library: we only had the time, at the end of March,
to talk about OrientDB and the ODM at the
<a href="http://www.slideshare.net/ingdavidino/graph-db-inphp">Codemotion</a>.</p>

<p>Since in the last week we restarted pairing together to
finalize a few open things in the library, I will explain what
is the current status of Orient.</p>

<h2>Beta-5</h2>

<p>We decided to put back our effort on the <code>beta-5</code> release,
instead of letting me complete the issues still belonging
to this version by myself.</p>

<p>In these days we are finalizing the integration tests for
OrientDB&rsquo;s native data types, and refactoring a bit the
implementation of the <strong>hydration mechanism</strong>, which will be more
configurable: we will release an ODM able to let the developer
decide what to do when an hydration error occurs (in other words,
you mapped an attribute as integer but in the OrientDB record
that attribute is mistakenly set as a date): before this
refactoring process <code>null</code> was returned by default, but now
you&rsquo;ll be able to decide whether to <a href="https://github.com/congow/Orient/blob/master/src/Congow/Orient/Formatter/Caster.php#L520">force the casting or raise an exception</a> for these errors.</p>

<p>As we complete these 2 tasks, we will remove the TODOs from
the codebase and then we will release this version which,
I remind it for those who are not up-2-date with the library&rsquo;s
lifecycle, is the one introducing <strong>hydration</strong>, which is the
ability to run SQL queries against an OrientDB instance and map
the results as PHP objects.</p>

<p>Similarly to Doctrine2, Orient offers the ability to map objects
from PHP to OrientDB via annotations:</p>

<p>``` php
&lt;?php</p>

<p>use Congow\Orient\ODM\Mapper\Annotations as ODM;</p>

<p>/<em>*
* @ODM\Document(class=&ldquo;Address&rdquo;)
</em>/
class Address
{</p>

<pre><code>/**
 * @ODM\Property(type="link")
 */
public $city;
</code></pre>

<p>}</p>

<p>```</p>

<h2>Doctrine ODM</h2>

<p>From the beginning, we&rsquo;ve been committed in finding a way to make
<a href="https://github.com/congow/Orient/blob/master/src/Congow/Orient/Contract/Protocol/Adapter.php#L23">interoperability</a>
a feature of Orient: another side of this issue is the fact that
we tried to stick to Doctrine2&rsquo;s design for lots of our problems,
from the implementation of mapping to lazy-loading through
auto-generated proxy classes.</p>

<p>In the last weeks I pro-actively asked the Doctrine2 community if they
would be happy in welcoming this project in their community, and the
responses we received were positive: as a result, after going out with
the <code>beta-5</code> release we will refactor the library&rsquo;s namespaces and move
the repository on Github.</p>

<p>There will be lots of things to do, lot of code to refactor, lot of
complaints from the Doctrine2 core members because of our &ldquo;strange&rdquo;
code, but this is a huge step towards a more robust PHP library
for OrientDB.</p>

<h2>Beta-6</h2>

<p>After the incubation inside the Doctrine organization we will re-start
working on the <code>beta-6</code> version, which will bundle <strong>persistence</strong> &ndash; the
ability to persist mapped PHP objects into OrientDB, using a couple
well known design patterns like the <a href="http://martinfowler.com/eaaCatalog/unitOfWork.html">unit of work</a>
and the <a href="http://martinfowler.com/eaaCatalog/identityMap.html">identity map</a>.</p>

<p>I won&rsquo;t commit myself in an estimate: <strong>this will take a long time</strong>,
especially if only me and <a href="http://davidfunaro.com">David</a> will keep
the good work on this library.</p>

<p>But since we had <strong>huge contributions</strong> from
<a href="https://github.com/nrk">Daniele Alessandri</a> and
are gonna be part of the Doctrine community, I bet we will be able to
deliver what promised in less than then what I currently think.</p>

<h2>RC</h2>

<p>Last but not least, there will be a few planned refactorings and feature
add-ons that we don&rsquo;t need now but are mandatory for a decent stable
version, which will come as we roll out our first <code>RC</code>.</p>

<h2>Thanks, again</h2>

<p>I could not keep my effort and motivation constant during
<a href="https://github.com/congow/Orient/commit/65929ec57a2e2cb1f4af034d722e17b5339b9d48">this year</a>
without your many &ldquo;thank you&rdquo;, your enthusiasm and
encouraging words: this is what makes me eager to type
with my fat fingers new LoCs dealing with PHP and NoSQL.</p>

<p>This won&rsquo;t be a library I wrote<sup id='fnref:1'><a href='#fn:1' rel='footnote'>1</a></sup>, this is something an entire
community was waiting for and contributed to.</p>

<p>So, <em>thank y'all</em>.</p>

<p><div class="footnotes">
<span>
Notes
</span>
	<ol>
		<li id='fn:1'>Although I still remember the first commit on Github: I was only wearing my underwear, alone in the hall of my flat <a href='#fnref:1' rev='footnote'>â†©</a></li>
	</ol>
</div>
</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Real-time scaling: when NoSQL almost wins, HTTP almost wins, and the customer smiles]]></title>
    <link href="http://odino.org/real-time-scaling-when-nosql-almost-wins-http-almost-wins-and-the-customer-smiles/"/>
    <updated>2011-05-06T15:42:00+04:00</updated>
    <id>http://odino.org/real-time-scaling-when-nosql-almost-wins-http-almost-wins-and-the-customer-smiles</id>
    <content type="html"><![CDATA[<p>There&rsquo;s a common goal that NoSQL and ESI share together: consistency.</p>

<p>Since <a href="http://www.slideshare.net/odino/http-cache-pug-rome-03292011/2">the web is inconsistent</a>, we should be able to find some hacks to make it more consistent and satisfy both us, reducing bandwidth, traffic and CPU load, and the end-user, decreasing the latency of our services.</p>

<!-- more -->


<h2>Edge Side Includes</h2>

<p>ESI is a specification written 10 years ago in order to let the reverse proxies being able to include <em>{insert media type here}</em> fragments in HTTP responses.</p>

<p>It&rsquo;s so useful because it let&rsquo;s you take advantage of HTTP&rsquo;s native caching specification without recurring to application caches for really dynamic pages.</p>

<p>An ESI tag is pretty straightforward:</p>

<p>``` xml
<html>
  <head>&hellip;</head>
  <body></p>

<pre><code>...
  &lt;esi:include src="http://odino.org/footer.html" /&gt;
...
</code></pre>

<p>  </body>
</html>
```</p>

<p>So, as you see, caching directives for webpages' fragments are now a matter of the protocol ( HTTP, in most cases ) and not of the application ( Symfony, DotNetNuke, Joomla, WordPress, Drupal, Django, Django REST framework, Ruby, Sinatra, &hellip; ).</p>

<p>This is so awesome because:</p>

<ul>
<li>it lets you scale when really dynamic data needs to be sent over the network</li>
<li>you don&rsquo;t have to re-invent the wheel with your application&rsquo;s caching layer</li>
<li>caching directives are a matter of the protocol, thus, if you&rsquo;ll change your application, caching configuration won&rsquo;t change</li>
</ul>


<h2>NoSQL</h2>

<p>The NoSQL movement is really old, but has been highlighted in the last 2/3 years.</p>

<p>At the italian NoSQLday I listened a talk about Redis and another one about SQL antipatterns which helped me contextualizing this DBMS: a few of them are out there in order to help you increase your performances without recurring to a caching mechanism, having the possibility to <strong>really</strong> show really real-time data.</p>

<p>Most of them are so fast, damn.</p>

<h2>A common goal</h2>

<p>Since, as we see, a few players are pointing towards a more consistent web, we should assume that this is the way to drive tecnology through: organizations like Facebook have to need to scale to milions of users mantaining the appearance of a real-time service, and the more they reach their goals, the more our customers pretend to act like them.</p>

<p>In order to &ldquo;<em>real-time scale</em>&rdquo; you can use a technology born a decade ago or another one which is on everyone&rsquo;s lips since a couple years.</p>

<p>The choice is yours: tools are always tools, but the architecture&rsquo;s design is something we, only we, can manage.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A simple menu and the relational model collapses]]></title>
    <link href="http://odino.org/a-simple-menu-and-the-relational-model-collapses/"/>
    <updated>2011-04-17T16:07:00+04:00</updated>
    <id>http://odino.org/a-simple-menu-and-the-relational-model-collapses</id>
    <content type="html"><![CDATA[<p>Relational sucks, some say.</p>

<p>That&rsquo;s not fair, because we used it for 30 years and we still need it: but there are some particular cases, out there, that relational, and traditional, databases can&rsquo;t handle well.</p>

<!-- more -->


<h2>The simple case of the menu</h2>

<p>You are building a CMS for your customer, and you just got to the point you need to develop <em>that</em> feature, the <strong>menu management system</strong>.</p>

<p>A menu is really simple, because it&rsquo;s an entity connected ( N to N ) with other entities ( menu items ).</p>

<p>So the class diagram is really simple:</p>

<p><img class="center" src="/images/Menuclassdiagram.png"></p>

<p>But there&rsquo;s a problem: not all of the menu items are equal; you can link an external URI or a news ( an entity of your model ).</p>

<p>There you basically have 2 choices: to de-normalize your data or to do <strong>column aggregation</strong>.</p>

<h2>Column aggregation</h2>

<p>You can simply create a single table, link, with a type column ( the type is usually used in order to <a href="http://www.doctrine-project.org/documentation/manual/1_2/en/inheritance:column-aggregation">work with an ORM</a> ):</p>

<p><img class="center" src="/images/Columnaggregation.png"></p>

<p>but the situation gets ridicolous, although your ORM may work fine with this pattern: as soon as your domain grows and you need to link more entities, you get</p>

<p><code>bash
(n-1) * r
</code></p>

<p><code>NULL</code>s in your table, given <code>n</code> as our entities and <code>r</code> the amount of rows.</p>

<p>Another problem is that the relations can be NULLable, and sometimes you can&rsquo;t afford it.</p>

<p>I like to call tables created with the column aggregation <strong>full-o'null</strong>, because they suck really much: despite this, they can save your life if you need to develop small system, with a modest domain; plus, they usually help you avoid UNIONs.</p>

<h2>De-normalization</h2>

<p>Subtitle: how to use a RDBMS as a non relational system.</p>

<p>Sub-subtitle: <strong>being an ass with RDBMS</strong>.</p>

<p>Normalization is one of the things we try to achieve with relational systems, so dropping it it&rsquo;s evil: we tend to consider de-normalization good as far as we recognize our data don&rsquo;t fit well in a RDBMS ( thus the problem it&rsquo;s not with MySQL or Oracle, it&rsquo;s our fault ).</p>

<p>But sometimes we like being asses, and we go for disrupting our relational DB.</p>

<p><img class="center" src="/images/Denormalization.png"></p>

<p>With this approach, you break the referential integrity, although you have much cleaner tables. I personally don&rsquo;t like it, but sometimes it&rsquo;s the fastest and most clever way to go.</p>

<h2>A menu, with its complications</h2>

<p>So, as you see, a menu ( something that should be really simple ) can undermine our data structure: and since we are used to relational data we think relational DBMS can handle very well this kind of problems.</p>

<p>That&rsquo;s, obviously, wrong, because relational databases have their limitations: they can&rsquo;t, for example, deal with <strong>semantic inheritance</strong>.</p>

<h2>The semantic inheritance dilemma</h2>

<p>A menu has N links, and each link differs from the others.</p>

<p>So a link basically has a relation with semantics ( &ldquo;I <strong>link</strong> in a menu&rdquo; ) and its inheritance ( links inherit from a base Link class ) but the relational systems aren&rsquo;t able to provide a way to express a relation, which has a single semantics, with entities from different sources ( = tables, roughly speaking ).</p>

<p>When you work with systems like <a href="http://www.orientechnologies.com/">OrientDB</a>, everything is done for you; being a NoSQL graph db:</p>

<ul>
<li>the system doesn&rsquo;t care, by itself, about referential integrity ( so you feel relieved :&ndash;) )</li>
<li>the system stores a direct link to express the relation</li>
<li>the system has a native API to easily retrieve linked objects</li>
</ul>


<p>For example, in OrientDB you can:</p>

<p><code>bash
select links from menu where @rid = [rid of the menu] // [29:0, 28:0, 28:1]
</code></p>

<p>as you see that returns you records from different classes ( <strong>29</strong>:0, <strong>28</strong>:0, &hellip; ), that you can retrieve with:</p>

<p><code>bash
select from [28:0, 28:1, 29:0, ...]
</code></p>

<p>Yes, awesome.</p>
]]></content>
  </entry>
  
</feed>
