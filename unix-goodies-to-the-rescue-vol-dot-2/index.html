
<!doctype html>
<!-- BEGIN _layouts/default.html -->
<html>
	<head>
		<meta charset="utf-8">
		
		<meta content="2nd edition of my personal unix faves: tools I couldn't live without." name="description">
		<meta content="Alessandro Nadalin" name="author">
		
		<title>Unix goodies to the rescue - Vol.2</title>
		<meta name="google-site-verification" content="dSNHLHJFQzKASjN8qHJisk2XLkKqbF_ilGSj9bscwKs" />
		<link href="/favicon.png" rel="icon">
		<link href="/stylesheets/screen.css" rel="stylesheet">
		<link href="/atom.xml" rel="alternate" title="Alessandro Nadalin" type="application/atom+xml">
		<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" type="text/css" href="/MyFontsWebfontsKit.css">

		<meta name="twitter:card" content="summary" />
		<meta name="twitter:creator" content="@_odino_" />
		<meta property="og:url" content="https://odino.org/unix-goodies-to-the-rescue-vol-dot-2/" />
		<meta property="og:title" content="Unix goodies to the rescue - Vol.2" />
		<meta property="og:description" content="2nd edition of my personal unix faves: tools I couldn't live without." />
		
	</head>
	<body>
		<div class="wrap">
			<header>
				<div class="navi">
					<ul>
                        <li><a href="/"><i class="icon-home icon-large"></i> Home</a></li>
                        <li><a href="/about"><i class="icon-user icon-large"></i> About</a></li>
                        <li><a href="/conferences"><i class="icon-group icon-large"></i> Conferences</a></li>
                        <li><a href="/archives"><i class="icon-briefcase icon-large"></i> Archives</a></li>
                        <li><a href="/atom.xml"><i class="icon-rss icon-large"></i> RSS</a></li>
					</ul>
				</div>
			</header>
			<!-- BEGIN _layouts/post.html -->

    <header>
        <h1><a href="/unix-goodies-to-the-rescue-vol-dot-2/">Unix goodies to the rescue - Vol.2</a></h1>
        <time>08 December 2017</time>
        <!-- 
        
        
        
          <br />
          <time>(note: this post was written 4 years ago and might be outdated)</time>
         -->
    </header>
<div class="entry-content "><p>A couple years ago I wrote a post presenting a few <a href="/4-unix-goodies-i-cannot-live-without/">unix commands that save me on
a daily basis</a>, and I thought it&rsquo;s probably
time to expand on that lists and add stuff I&rsquo;ve grown fond of over the past few years.</p>

<!-- more -->


<h2>Locating a binary</h2>

<p>I just downloaded an updated version of <a href="https://www.terraform.io/">terraform</a> and I want to replace the old one I
have in my system. The problem is&hellip;I can&rsquo;t remember where I placed it, and my
<code>$PATH</code> looks very confusing:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~ ᐅ echo $PATH
</span><span class='line'>/usr/local/heroku/bin:/home/alex/local/bin:/home/alex/bin:/home/alex/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/lib/go-1.9/bin:/bin:/home/alex/Downloads:/home/alex/Downloads/google-cloud-sdk/bin:/usr/local/sbin:/usr/local/bin:/home/alex/local/node/bin:/home/alex/projects/go/bin:/home/alex/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/home/alex/.rvm/gems/ruby-2.0.0-p195/bin:/home/alex/.rvm/gems/ruby-2.0.0-p195@global/bin:/home/alex/.rvm/rubies/ruby-2.0.0-p195/bin:/home/alex/.rvm/bin:/usr/lib/lightdm/lightdm:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/home/alex/.rvm/bin:/home/alex/.rvm/bin:/home/alex/.rvm/bin:/home/alex/.rvm/bin</span></code></pre></td></tr></table></div></figure>


<p>Fear no more, as <code>which</code> can be used to instantly locate binaries:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~ ᐅ which terraform
</span><span class='line'>/home/alex/bin/terraform
</span><span class='line'>
</span><span class='line'>~ ᐅ mv ./new-terraform $(which terraform)</span></code></pre></td></tr></table></div></figure>


<p>If your script is, for example, a bash script, you can even edit it by just <code>vi $(which $SCRIPT)</code>.</p>

<h2>awk</h2>

<p>Once an <em>awk-er</em>, always an awk-er.</p>

<p>I find myself using awk mostly when I need to run bash commands based on the input of
another command. For example, let&rsquo;s say I want to ping all hosts that are mapped to
<code>127.x.x.x</code> from my <code>/etc/host</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~ ᐅ cat /etc/hosts
</span><span class='line'>127.0.0.1 localhost
</span><span class='line'>127.0.1.1 puma
</span><span class='line'>
</span><span class='line'># minikube
</span><span class='line'>192.168.99.100 kube.local
</span><span class='line'>
</span><span class='line'># The following lines are desirable for IPv6 capable hosts
</span><span class='line'>::1     ip6-localhost ip6-loopback
</span><span class='line'>fe00::0 ip6-localnet
</span><span class='line'>ff00::0 ip6-mcastprefix
</span><span class='line'>ff02::1 ip6-allnodes
</span><span class='line'>ff02::2 ip6-allrouters
</span><span class='line'>
</span><span class='line'>~ ᐅ cat /etc/hosts | grep 127 | awk '{print "ping -c 1 " $2}'
</span><span class='line'>ping -c 1 localhost
</span><span class='line'>ping -c 1 puma
</span><span class='line'>
</span><span class='line'>~ ᐅ cat /etc/hosts | grep 127 | awk '{print "ping -c 1 " $2}' | bash
</span><span class='line'>PING localhost (127.0.0.1) 56(84) bytes of data.
</span><span class='line'>64 bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.076 ms
</span><span class='line'>
</span><span class='line'>--- localhost ping statistics ---
</span><span class='line'>1 packets transmitted, 1 received, 0% packet loss, time 0ms
</span><span class='line'>rtt min/avg/max/mdev = 0.076/0.076/0.076/0.000 ms
</span><span class='line'>PING puma (127.0.1.1) 56(84) bytes of data.
</span><span class='line'>64 bytes from puma (127.0.1.1): icmp_seq=1 ttl=64 time=0.051 ms
</span><span class='line'>
</span><span class='line'>--- puma ping statistics ---
</span><span class='line'>1 packets transmitted, 1 received, 0% packet loss, time 0ms
</span><span class='line'>rtt min/avg/max/mdev = 0.051/0.051/0.051/0.000 ms</span></code></pre></td></tr></table></div></figure>


<p>I was introduced to awk ~8 years ago, when SVN was still a thing &mdash; if I remember correctly,
SVN did not allow an &ldquo;add all&rdquo; like git (<code>git add .</code>), so you had to mark all files you
wanted to commit separately, and that&rsquo;s when awk started to become handy.</p>

<h2>Do I have to type it all over AGAIN?</h2>

<p>How many times have you found yourself in the middle of a long-ass command when you
realize you need to run something else before that? Are you going yo throw away all
you&rsquo;ve typed so far?</p>

<p>Well, add a comment to that command, press enter and re-run it later on:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~ ᐅ #cat /etc/hosts | grep 127 | awk '{print "ping -c 1 " $2}' | bash
</span><span class='line'>
</span><span class='line'>~ ᐅ echo "127.0.0.1 noplacelikehome.com" &gt;&gt; /etc/hosts
</span><span class='line'>
</span><span class='line'>~ ᐅ cat /etc/hosts | grep 127 | awk '{print "ping -c 1 " $2}' | bash
</span><span class='line'>PING localhost (127.0.0.1) 56(84) bytes of data.
</span><span class='line'>64 bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.091 ms
</span><span class='line'>
</span><span class='line'>--- localhost ping statistics ---
</span><span class='line'>1 packets transmitted, 1 received, 0% packet loss, time 0ms
</span><span class='line'>rtt min/avg/max/mdev = 0.091/0.091/0.091/0.000 ms
</span><span class='line'>PING puma (127.0.1.1) 56(84) bytes of data.
</span><span class='line'>64 bytes from puma (127.0.1.1): icmp_seq=1 ttl=64 time=0.060 ms
</span><span class='line'>
</span><span class='line'>--- puma ping statistics ---
</span><span class='line'>1 packets transmitted, 1 received, 0% packet loss, time 0ms
</span><span class='line'>rtt min/avg/max/mdev = 0.060/0.060/0.060/0.000 ms
</span><span class='line'>PING noplacelikehome.com (127.0.0.1) 56(84) bytes of data.
</span><span class='line'>64 bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.039 ms
</span><span class='line'>
</span><span class='line'>--- noplacelikehome.com ping statistics ---
</span><span class='line'>1 packets transmitted, 1 received, 0% packet loss, time 0ms
</span><span class='line'>rtt min/avg/max/mdev = 0.039/0.039/0.039/0.000 ms</span></code></pre></td></tr></table></div></figure>


<p>Oversimplifying: when you hit enter in the terminal you end up running a bash one-liner,
so if you prepend <code>#</code> to the command, it will simply be executed as a comment &mdash; but will
still be saved in your history.</p>

<h2>Decoding base64 text</h2>

<p>If you, like me, end up dealing with base64 input (k8s&#8217; secrets anyone?) it could
be really handy to just decode it on the fly through a pipe:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~ ᐅ echo MTIzNAo= | base64 -d
</span><span class='line'>1234</span></code></pre></td></tr></table></div></figure>


<h2>Repeating a command</h2>

<p>This is a glorified version of a for loop, but <code>repeat</code> comes really handy sometimes:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~ ᐅ repeat 1000 echo hello && sleep 1
</span><span class='line'>hello
</span><span class='line'>hello
</span><span class='line'>hello
</span><span class='line'>^C%</span></code></pre></td></tr></table></div></figure>


<p>I generally use this as a poor man&rsquo;s benchmarking tool when I want to generate little
traffic on an endpoint (eg. a staging service) and compare pre/post some changes (It&rsquo;s
not a benchmarking tool but gives you a good idea early on without having to go through
<a href="https://github.com/tsenart/vegeta">vegeta</a> or similar stuff.</p>

<h2>Sleeping forever</h2>

<p>Sometimes you want to be able to halt a program indefinitely, or until a <code>ctrl+c</code> kicks
in.</p>

<p>You could use a while loop and a sleep or, on some systems, simply sleep forever:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~ ᐅ sleep infinity
</span><span class='line'>
</span><span class='line'>(black hole here)</span></code></pre></td></tr></table></div></figure>


<p>Worth to note that infinity is only available on a few linux systems (I think both ubuntu
and debian support it but, for example, alpine doesn&rsquo;t) so you might have to end up using
a while loop for portability.</p>

<h2>Waiting for background tasks</h2>

<p>This is something I&rsquo;ve been using in bash scripts, when I want to run things in
parallel and be able to do some other work once all of them are done (think, for example,
of backing up several mysql tables in parallel and then move them to s3 in one go) &mdash;  you can simply
move processes to the background and <code>wait</code> for them to finish:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~ ᐅ echo "start"; sleep 1 & sleep 2 & sleep 3 & echo "scheduled"; wait; echo "done"
</span><span class='line'>start
</span><span class='line'>[1] 5922
</span><span class='line'>[2] 5923
</span><span class='line'>[3] 5924
</span><span class='line'>scheduled
</span><span class='line'>[1]    5922 done       sleep 1
</span><span class='line'>[2]  - 5923 done       sleep 2
</span><span class='line'>[3]  + 5924 done       sleep 3
</span><span class='line'>done</span></code></pre></td></tr></table></div></figure>

</div>



<div class="recent entry-content">
  <hr class="divider-cazzuto">
  <h3>
    In the mood for some more reading?
  </h3>
  <ul>
    
      <li><a href="/dell-xps-13-9310-usb-c-port-not-recognizing-external-devices/">Dell XPS 13 9310: USB-C port not recognizing external devices</a> (25 July 2021)</li>
    
      <li><a href="/book-review-working-backwards/">Book review: Working Backwards</a> (24 July 2021)</li>
    
      <li><a href="/fwupd-is-the-best-thing-that-ever-happened-to-linux/">fwupd is the best thing that ever happened to Linux</a> (15 April 2021)</li>
    
      <li><a href="/avoid-battery-draining-on-your-linux-flavored-dell-xps/">Avoid battery draining on your Linux-flavored Dell XPS</a> (31 January 2021)</li>
    
      <li><a href="/combining-two-numbers-into-a-unique-one-pairing-functions/">Combining two numbers into a unique one: pairing functions</a> (05 December 2020)</li>
    
      <li><a href="/running-ci-tests-in-kubernetes-through-github-actions/">Running CI tests in Kubernetes through Github Actions</a> (20 March 2020)</li>
    
      <li><a href="/ive-decided-to-make-the-wasec-ebook-free-during-these-trying-times/">I've decided to make the WASEC ebook free during these trying times</a> (20 March 2020)</li>
    
  </ul>
    <p>
      ...or <a href="/archives/">check the archives</a>.
    </p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.0/anchor.min.js"></script>
<script type="text/javascript" />
(function () {
  'use strict';

  anchors.options = {
    placement: 'left',
    visible: 'hover',
    icon: '¶'
  };

  anchors.add('h2');
  anchors.add('h3');
  anchors.add('h4');

})();
</script>

			<footer>
				<center>
	Copyleft <!--[if lte IE 8]><span style="filter: FlipH; -ms-filter: "FlipH"; display: inline-block;"><![endif]--><span style="-moz-transform: scaleX(-1); -o-transform: scaleX(-1); -webkit-transform: scaleX(-1); transform: scaleX(-1); display: inline-block;">©</span><!--[if lte IE 8]></span><![endif]--> 2021 — Alessandro Nadalin
	<address>
	</address>
</center>
			</footer>
		</div>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-7407627-3', 'auto');
      ga('send', 'pageview');
	</script>
	
	<script type="application/ld+json">
		{
		"@context": "https://schema.org/",
		"@type": "BlogPosting",
		"mainEntityOfPage": {
			"@type": "WebPage",
			"@id": "https://odino.org/unix-goodies-to-the-rescue-vol-dot-2/"
		},
		"headline": "Unix goodies to the rescue - Vol.2",
		"description": "2nd edition of my personal unix faves: tools I couldn't live without.",
		
		"author": {
			"@type": "Person",
			"name": "Alessandro Nadalin"
		},
		"datePublished": "2017-12-08 19:20:00 +0000"
		}
	</script>
	
	</body>
</html>
<!-- END _layouts/default.html -->
