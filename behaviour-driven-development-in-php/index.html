
<!doctype html>
<!-- BEGIN _layouts/default.html -->
<html>
	<head>
		<meta charset="utf-8">
		
		<meta content="Blog of Alex, technologist in Dubai: writing about Service Oriented Architectures, web APIs and development teams." name="description">
		<meta content="Alessandro Nadalin" name="author">
		
		<title>Behaviour-driven development in PHP</title>
		<meta name="google-site-verification" content="dSNHLHJFQzKASjN8qHJisk2XLkKqbF_ilGSj9bscwKs" />
		<link href="/favicon.png" rel="icon">
		<link href="/stylesheets/screen.css" rel="stylesheet">
		<link href="/atom.xml" rel="alternate" title="Alessandro Nadalin" type="application/atom+xml">
		<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" type="text/css" href="/MyFontsWebfontsKit.css">

		<meta name="twitter:card" content="summary" />
		<meta name="twitter:creator" content="@_odino_" />
		<meta property="og:url" content="https://odino.org/behaviour-driven-development-in-php/" />
		<meta property="og:title" content="Behaviour-driven development in PHP" />
		<meta property="og:description" content="Blog of Alex, technologist in Dubai: writing about Service Oriented Architectures, web APIs and development teams." />
		
	</head>
	<body>
		<div class="wrap">
			<header>
				<div class="navi">
					<ul>
                        <li><a href="/"><i class="icon-home icon-large"></i> Home</a></li>
                        <li><a href="/about"><i class="icon-user icon-large"></i> About</a></li>
                        <li><a href="/conferences"><i class="icon-group icon-large"></i> Conferences</a></li>
                        <li><a href="/archives"><i class="icon-briefcase icon-large"></i> Archives</a></li>
                        <li><a href="/atom.xml"><i class="icon-rss icon-large"></i> RSS</a></li>
					</ul>
				</div>
			</header>
			<!-- BEGIN _layouts/post.html -->

    <header>
        <h1><a href="/behaviour-driven-development-in-php/">Behaviour-driven development in PHP</a></h1>
        <time>27 August 2011</time>
        <!-- 
        
        
        
          <br />
          <time>(note: this post was written 11 years ago and might be outdated)</time>
         -->
    </header>
<div class="entry-content "><p><a href="http://en.wikipedia.org/wiki/Behavior_Driven_Development">BDD</a> is an established practice which goes beyond test-driven development, assuming we are working on a agile-prone environment and our requirements are expressed as user stories or something similar: although this requirement is not mandatory, <strong>BDD&rsquo;s power is leveraged by using stories</strong>.</p>

<!-- more -->


<p>It basically assumes that instead of focusing on tests, we should start our development process writing down <a href="http://docs.behat.org/quick_intro.html">a story that a parser can translate into a test</a> (a customer cares about features, not tests) a programmer can implement in order to verify that our software respects that story.</p>

<h2>Why BDD?</h2>

<p>It&rsquo;s a pretty unconvenient question :)</p>

<p>Do you know why TDD is extremely powerful? If not, go check it on the web; if so, add to TDD the ability of <strong>writing tests in a ubiquitous language</strong>, letting the team share tests, user-stories and acceptance criteria without the pain of translating an actual story in a functional test that, for example, a customer could never understand.</p>

<h2>Getting started</h2>

<p>I was introduced to BDD by <a href="http://www.linkedin.com/pub/roberto-bettazzoni/2/12b/614">Roberto Bettazzoni</a> at the italian agile day 2010, during a dummy-proof session in which <a href="http://cukes.info/">cucumber</a> was used.</p>

<p>Although you can use Cucumber in your PHP projects (the implementation of the tests, however, should be written in Ruby), Behat is an excellent project which brings native BDD in PHP.</p>

<p>You can &ndash; and I recommend it &ndash;  <a href="http://pear.behat.org/">install it via PEAR</a>: just make sure you have all the required dependencies by running a simple</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>behat</span></code></pre></td></tr></table></div></figure>


<p>after the installation: we had our daily WTF last week because <a href="http://mink.behat.org/">Mink</a>, a browser-emulator abstraction layer required by Behat, wasn&rsquo;t properly installed.</p>

<h2>The integration with symfony 1.4</h2>

<p>From <a href="http://www.dnsee.com/">our POV</a>, we use Behat in a pilot project written in symfony: you only need to install <a href="http://www.symfony-project.org/plugins/sfBehatPlugin">sfBehatPlugin</a> and configure the <code>behat.yml</code> file you find under <code>/config</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">// behat.yml default config</span>
</span><span class='line'><span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
</span><span class='line'>  <span class="l-Scalar-Plain">paths</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="l-Scalar-Plain">features</span><span class="p-Indicator">:</span> <span class="err">%%</span><span class="l-Scalar-Plain">BEHAT_CONFIG_PATH%%/../test/features/frontend</span>
</span><span class='line'>  <span class="l-Scalar-Plain">context</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="l-Scalar-Plain">parameters</span><span class="p-Indicator">:</span>
</span><span class='line'>      <span class="l-Scalar-Plain">base_url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>
</span></code></pre></td></tr></table></div></figure>


<p>and then you can run</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">behat</span>
</span></code></pre></td></tr></table></div></figure>


<p>from the root of your symfony project: no tests, so let&rsquo;s write something!</p>

<p>In symfony, behat&rsquo;s tests are located under <code>/test/features</code>, and are a <code>.feature</code> file, looking like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">Feature</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">US-1</span>
</span><span class='line'>  <span class="l-Scalar-Plain">As anonymous</span>
</span><span class='line'>  <span class="l-Scalar-Plain">I want to open the homepage</span>
</span><span class='line'>  <span class="l-Scalar-Plain">in order to know WTF this site is about</span>
</span><span class='line'>
</span><span class='line'><span class="l-Scalar-Plain">Scenario</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">anonymous user reaches the site&#39;s homepage, viewing it without errors</span>
</span><span class='line'>   <span class="l-Scalar-Plain">Given I am on &quot;homepage&quot;</span>
</span><span class='line'>    <span class="l-Scalar-Plain">Then I should see &quot;This website is about crap&quot; in the &quot;body&quot; element</span>
</span><span class='line'>     <span class="l-Scalar-Plain">And The page loads correctly</span>
</span></code></pre></td></tr></table></div></figure>


<p>So, let&rsquo;s examine it:</p>

<ul>
<li>this &ldquo;code&rdquo; should be located in the <code>/test/features/homepageOk.feature</code> file</li>
<li>the <code>Feature</code> element defines the story you are working on (write it as it appears in your backlog)</li>
<li>every <code>Scenario</code> block identifies possible declinations for your story (user logs in with good credentials, user tries to log in with incorrect credentials and so on)</li>
<li>the sentences inside every scenario are the actual testers which are parsed by behat and <strong>translated in actual PHP code</strong></li>
</ul>


<h2>Translated in actual PHP code?</h2>

<p>Yes, because you have a <code>FeatureContext</code> class in which you define some methods that are your tests&#8217; implementations: BDD frameworks usually parse your scenarios&#8217; lines generating the code you need to implement.</p>

<p>Behat, for example, stores all its testers in the <code>FeatureContext</code> class, and when you write a new scenario, if Behat doesn&rsquo;t know its syntax, it outputs something like:</p>

<p><img class="center" src="/images/behat.png"></p>

<p>so you only need to <em>copy&amp;paste</em> the method in your <code>FeatureContext</code> and implement the method with your logic.</p>

<p>Obviously, BDD frameworks have a set of predefined testers: you can see Behat&rsquo;s ones with</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">behat --definitions</span>
</span></code></pre></td></tr></table></div></figure>


<p>you will see testers like <code>I should see [...]</code> which tests if the given text lies in the response.</p>

<h2>Producing ubiquitous documentation</h2>

<p>The cool thing is that, when you run your BDD test suite, you can export it in a fancy way, making it readable for every project&rsquo;s stakeholder:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">behat --out heyGuysReadThis.html --format html</span>
</span></code></pre></td></tr></table></div></figure>


<p>obtaining something like:</p>

<p><img class="center" src="/images/behat-report.png"></p>

<h2>I won&rsquo;t be exhaustive, so what&rsquo;s next?</h2>

<p>No focus on how to use (<em>deeply</em> use) Behat here: it will be a matter of another post.</p>

<p>Then we will see how to use <a href="http://capifony.org/">capifony</a> to automatically deploy your symfony applications and produce acceptance criteria tests that will be used by your QA guys in order to test your brand new deployment.</p>
</div>



<div class="recent entry-content">
  <hr class="divider-cazzuto">
  <h3>
    In the mood for some more reading?
  </h3>
  <ul>
    
      <li><a href="/dell-xps-13-9310-usb-c-port-not-recognizing-external-devices/">Dell XPS 13 9310: USB-C port not recognizing external devices</a> (25 July 2021)</li>
    
      <li><a href="/book-review-working-backwards/">Book review: Working Backwards</a> (24 July 2021)</li>
    
      <li><a href="/fwupd-is-the-best-thing-that-ever-happened-to-linux/">fwupd is the best thing that ever happened to Linux</a> (15 April 2021)</li>
    
      <li><a href="/avoid-battery-draining-on-your-linux-flavored-dell-xps/">Avoid battery draining on your Linux-flavored Dell XPS</a> (31 January 2021)</li>
    
      <li><a href="/combining-two-numbers-into-a-unique-one-pairing-functions/">Combining two numbers into a unique one: pairing functions</a> (05 December 2020)</li>
    
      <li><a href="/running-ci-tests-in-kubernetes-through-github-actions/">Running CI tests in Kubernetes through Github Actions</a> (20 March 2020)</li>
    
      <li><a href="/ive-decided-to-make-the-wasec-ebook-free-during-these-trying-times/">I've decided to make the WASEC ebook free during these trying times</a> (20 March 2020)</li>
    
  </ul>
    <p>
      ...or <a href="/archives/">check the archives</a>.
    </p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.0/anchor.min.js"></script>
<script type="text/javascript" />
(function () {
  'use strict';

  anchors.options = {
    placement: 'left',
    visible: 'hover',
    icon: '¶'
  };

  anchors.add('h2');
  anchors.add('h3');
  anchors.add('h4');

})();
</script>

			<footer>
				<center>
	Copyleft <!--[if lte IE 8]><span style="filter: FlipH; -ms-filter: "FlipH"; display: inline-block;"><![endif]--><span style="-moz-transform: scaleX(-1); -o-transform: scaleX(-1); -webkit-transform: scaleX(-1); transform: scaleX(-1); display: inline-block;">©</span><!--[if lte IE 8]></span><![endif]--> 2022 — Alessandro Nadalin
	<address>
	</address>
</center>
			</footer>
		</div>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-7407627-3', 'auto');
      ga('send', 'pageview');
	</script>
	
	<script type="application/ld+json">
		{
		"@context": "https://schema.org/",
		"@type": "BlogPosting",
		"mainEntityOfPage": {
			"@type": "WebPage",
			"@id": "https://odino.org/behaviour-driven-development-in-php/"
		},
		"headline": "Behaviour-driven development in PHP",
		"description": "Blog of Alex, technologist in Dubai: writing about Service Oriented Architectures, web APIs and development teams.",
		
		"author": {
			"@type": "Person",
			"name": "Alessandro Nadalin"
		},
		"datePublished": "2011-08-27 23:32:00 +0000"
		}
	</script>
	
	</body>
</html>
<!-- END _layouts/default.html -->
